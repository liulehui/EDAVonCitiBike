stat_summary(fun.y="mean", geom = "line", colour="steelblue", size=1)
ggplot(data = df_weather,
aes(x=factor(Severe), y=minute))+
xlab("Severity of weather")+ylab("Average trip length")+
stat_summary(fun.y="mean", geom="bar")
df_by_temp <- df_weather %>% group_by(Temperature) %>% summarise(n_distinct(starttime))
ggplot(data = df_by_temp, aes(x=as.numeric(Temperature), y=`n_distinct(starttime)`))+
stat_summary(geom="bar", fill="steelblue")+
xlab("Temperature")+
ylab("Average trips per day")+
ggtitle("Average daily trips in different temperatures")
df_by_windspeed <- df_weather %>% group_by(Windspeed) %>% summarise(n_distinct(starttime))
ggplot(data = df_by_windspeed, aes(x=as.numeric(Windspeed), y=`n_distinct(starttime)`))+
stat_summary(geom="bar", fill="steelblue")+
xlab("Windspeed")+
ylab("Average trips per day")+
ggtitle("Average daily trips in different windspeeds")
df_by_precip <- df_weather %>% group_by(Precipitation) %>% summarise(n_distinct(starttime))
ggplot(data = df_by_precip, aes(x=as.numeric(Precipitation), y=`n_distinct(starttime)`))+
stat_summary(geom="bar", fill="steelblue")+
xlab("Precipitation")+
ylab("Average trips per day")+
ggtitle("Average daily trips in different precipitations")
df_timeseries <- read.csv('./data/data_2017_2018.csv')
a <- mdy_hms(df_timeseries$starttime)
b <- as.Date(df_timeseries$starttime)
b[is.na(b)] <- a[!is.na(a)]
df_timeseries$starttime <- b
df_timeseries <- df_timeseries %>% mutate(time = format(as.Date(starttime), "%Y-%m"))
df_timeseries <- df_timeseries[,c("time","usertype")]
df_timeseries <- read.csv('./data/data_2017_2018.csv')
a <- lubridate::mdy_hms(df_timeseries$starttime)
b <- as.Date(df_timeseries$starttime)
b[is.na(b)] <- a[!is.na(a)]
df_timeseries$starttime <- b
df_timeseries <- df_timeseries %>% mutate(time = format(as.Date(starttime), "%Y-%m"))
df_timeseries <- df_timeseries[,c("time","usertype")]
df_subscriber <- df_timeseries %>% subset(usertype == 'Subscriber')
df_customer <- df_timeseries %>% subset(usertype == 'Customer')
df_subscriber <- df_subscriber %>% group_by(time) %>% summarise(Number = n())
df_customer <- df_customer %>% group_by(time) %>% summarise(Number = n())
ts_subscriber <- xts(df_subscriber$Number,as.Date(as.yearmon(df_subscriber$time)))
ts_customer <- xts(df_customer$Number,as.Date(as.yearmon(df_customer$time)))
ts <- cbind(ts_subscriber,ts_customer)
dygraph(ts,main = 'Impact of season',ylab = "Frequency") %>% dySeries('..1',label = 'subscriber ') %>% dySeries('..2',label = 'customer') %>% dyLegend(show = "always", hideOnMouseOut = FALSE,width=400) %>%
dyOptions(colors = RColorBrewer::brewer.pal(3, "Set2"))
df_timeseries <- read.csv('./data/data_2017_2018.csv')
a <- lubridate::mdy_hms(df_timeseries$starttime)
b <- as.Date(df_timeseries$starttime)
b[is.na(b)] <- a[!is.na(a)]
df_timeseries$starttime <- b
df_timeseries <- df_timeseries %>% mutate(time = format(as.Date(starttime), "%Y-%m"))
df_timeseries <- df_timeseries[,c("time","usertype")]
df_subscriber <- df_timeseries %>% subset(usertype == 'Subscriber')
df_customer <- df_timeseries %>% subset(usertype == 'Customer')
df_subscriber <- df_subscriber %>% group_by(time) %>% summarise(Number = n())
df_customer <- df_customer %>% group_by(time) %>% summarise(Number = n())
ts_subscriber <- xts(df_subscriber$Number,as.Date(as.yearmon(df_subscriber$time)))
ts_customer <- xts(df_customer$Number,as.Date(as.yearmon(df_customer$time)))
ts <- cbind(ts_subscriber,ts_customer)
dygraph(ts,main = 'Impact of season',ylab = "Frequency") %>% dySeries('..1',label = 'subscriber ') %>% dySeries('..2',label = 'customer') %>% dyLegend(show = "always", hideOnMouseOut = FALSE,width=400) %>%
dyOptions(colors = RColorBrewer::brewer.pal(3, "Set2"))
library(lubridate)
df_timeslot <- mutate(df,hour = hour(as.POSIXct(starttime)))
df_timeslot <- mutate(df_timeslot,wday = wday(as.POSIXct(starttime)))
df_timeslot <- df_timeslot[,c("hour","wday","minute","start.station.name","usertype")]
timeslot <- ggplot(data=df_timeslot,mapping=aes(as.factor(hour))) +geom_bar(color='Orange')+ggtitle('Time slot in trip data group by usertype')
timeslot + facet_wrap(~usertype)
timeslot <- ggplot(data=df_timeslot,mapping=aes(as.factor(hour))) +geom_bar(color='Orange')+ggtitle('Time slot in trip data group by weekdays')
timeslot + facet_wrap(~as.factor(wday))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(forcats)
df <- read.csv("./final/data_201806.csv")
df2 <- df %>% group_by('start_id')
library(dplyr)
library(ggplot2)
library(forcats)
df <- read.csv("./final/data_201806.csv")
df2 <- df %>% group_by('start_id')
df2
library(dplyr)
library(ggplot2)
library(forcats)
df <- read.csv("./final/data_201806.csv")
df2 <- df[,c('start.station.id','start.station.name','start.station.latitude','start.station.longitude')]%>% group_by('start.station.id')
df2
library(dplyr)
library(ggplot2)
library(forcats)
df <- read.csv("./final/data_201806.csv")
df2 <- df[,c('start.station.id','start.station.name','start.station.latitude','start.station.longitude')]%>% group_by(start.station.id)
df2
library(dplyr)
library(ggplot2)
library(forcats)
df <- read.csv("./final/data_201806.csv")
df2 <- df[,c('start.station.id','start.station.name','start.station.latitude','start.station.longitude')]%>% group_by(start.station.id) %>% summarise(Freq=n()) %>% arrange(Freq)
df2
library(dplyr)
library(ggplot2)
library(forcats)
df <- read.csv("./final/data_201806.csv")
df2 <- df[,c('start.station.id','start.station.name','start.station.latitude','start.station.longitude')]%>% group_by(start.station.id) %>% summarise(Freq=n()) %>% arrange(desc(Freq))
df2
library(dplyr)
library(ggplot2)
library(forcats)
df <- read.csv("./final/data_201806.csv")
df2 <- df[,c('start.station.id','start.station.name','start.station.latitude','start.station.longitude')]%>% group_by(start.station.id,start.station.latitude,start.station.longitude) %>% summarise(Freq=n()) %>% arrange(desc(Freq))
df2
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(ggmap)
library(leaflet)
library(leaflet.extras)
df <- read.csv('./201806-citibike-tripdata.csv')
knitr::opts_chunk$set(echo = TRUE,warning = FALSE,message = FALSE)
data_16_6 = read.csv("./data/201606-citibike-tripdata.csv")
data_17_6 = read.csv("./data/201706-citibike-tripdata.csv")
data_17_12 = read.csv("./data/201712-citibike-tripdata.csv")
data_18_1 = read.csv("./data/201801-citibike-tripdata.csv")
data_18_5 = read.csv("./data/201805-citibike-tripdata.csv")
data_18_6 = df
data_18_5 = data_18_5 %>% mutate(minute=tripduration/60)%>%
filter(minute<120 & minute>0)
data_17_6 = data_17_6 %>% mutate(minute=tripduration/60)%>%
filter(minute<120 & minute>0)
data_16_6 = data_16_6 %>% mutate(minute=tripduration/60)%>%
filter(minute<120 & minute>0)
data_17_12 = data_17_12 %>% mutate(minute=tripduration/60)%>%
filter(minute<120 & minute>0)
data_18_1 = data_18_1 %>% mutate(minute=tripduration/60)%>%
filter(minute<120 & minute>0)
data_18_6$factor_year = as.factor(data_18_6$birth.year)
summary_18_6 = data_18_6 %>% group_by(factor_year) %>%
summarise(Freq = n()) %>%
arrange(desc(Freq)) #1969
summary_18_6 = mutate(summary_18_6, time = rep("201806", nrow(summary_18_6)))
data_17_6$factor_year = as.factor(data_17_6$birth.year)
summary_17_6 = data_17_6 %>% group_by(factor_year) %>%
summarise(Freq = n()) %>%
arrange(desc(Freq)) #NULL
summary_17_6 = mutate(summary_17_6, time = rep("201706", nrow(summary_17_6)))
data_16_6$factor_year = as.factor(data_16_6$birth.year)
summary_16_6 = data_16_6 %>% group_by(factor_year) %>%
summarise(Freq = n()) %>%
arrange(desc(Freq)) #NULL
summary_16_6 = mutate(summary_16_6, time = rep("201606", nrow(summary_16_6)))
data_17_12$factor_year = as.factor(data_17_12$birth.year)
summary_17_12 = data_17_12 %>% group_by(factor_year) %>%
summarise(Freq = n()) %>%
arrange(desc(Freq)) #NULL
summary_17_12 = mutate(summary_17_12, time = rep("201712", nrow(summary_17_12)))
data_18_1$factor_year = as.factor(data_18_1$birth.year)
summary_18_1 = data_18_1 %>% group_by(factor_year) %>%
summarise(Freq = n()) %>%
arrange(desc(Freq)) #1969
summary_18_1 = mutate(summary_18_1, time = rep("201801", nrow(summary_18_1)))
data_18_5$factor_year = as.factor(data_18_5$birth.year)
summary_18_5 = data_18_5 %>% group_by(factor_year) %>%
summarise(Freq = n()) %>%
arrange(desc(Freq)) #1969
summary_18_5 = mutate(summary_18_5, time = rep("201805", nrow(summary_18_5)))
table = rbind(summary_16_6[1:3,], summary_17_6[1:3,], summary_17_12[1:3,],
summary_18_1[1:3,], summary_18_5[1:3,],summary_18_6[1:3,])
table$factor_year= as.character(table$factor_year)
table[1,1] = "NULL"
table$factor_year = factor(table$factor_year)
ggplot(table, aes(x = factor_year, y = Freq)) +
geom_bar(stat='identity', fill = "#fb6a4a", alpha = 0.8) +
facet_wrap(~factor(time)) +
xlab("users' birth year") +
ylab("frequency") +
ggtitle("Top Three Users' Birth Year")
library(ggplot2)
library(dplyr)
library(ggmap)
library(leaflet)
library(leaflet.extras)
df <- read.csv('./201806-citibike-tripdata.csv')
df <- df %>% mutate(minute=tripduration/60)
overalltripduration <-  ggplot(data=df,mapping=aes(x=1,y=minute)) + geom_boxplot(fill='#fb6a4a')+ggtitle('Distribution of time duration')
overalltripduration + theme_grey(16)
overalltripduration <-  ggplot(data=df,mapping=aes(x=usertype,y=minute)) + geom_boxplot(fill='#fb6a4a')+ggtitle('Distribution of time duration')
overalltripduration + theme_grey(16)
df <- subset(df,minute<120 & minute>0)
overalltripduration2 <-  ggplot(data=df,mapping=aes(x=usertype,y=minute)) + geom_boxplot(fill='#fb6a4a')+ggtitle('Distribution of time duration')
overalltripduration2 + theme_grey(16)
overalltripduration3 <- ggplot(data=df,mapping=aes(minute)) + geom_histogram(fill='#fb6a4a',color='black')+ggtitle('Distribution of time duration')
overalltripduration3 + theme_grey(16)
summary = df %>%
group_by(start.station.id) %>%
summarise(lat=as.numeric(start.station.latitude[1]),
long=as.numeric(start.station.longitude[1]),
name=start.station.name[1],
n.trips=n())
leaflet(summary) %>%setView(-74.00, 42.71, zoom = 6) %>%
addProviderTiles("CartoDB.Positron") %>%
addCircles(lng = ~long, lat = ~lat, col = "#fb6a4a")
id = which(df$start.station.latitude > 45)
df = df[-id,]
df$factor_year = as.factor(df$birth.year)
summary_18_6 = df %>% group_by(factor_year) %>%
summarise(Freq = n()) %>%
arrange(desc(Freq))
summary_18_6 = mutate(summary_18_6, time = rep("201806", nrow(summary_18_6)))
ggplot(summary_18_6, aes(x = factor_year, y = Freq)) + geom_point(col = "#fb6a4a") +
coord_flip() + xlab("user's birth year") +
ggtitle("Frequency of Citi Bike users' birth year in 2018/6")
data_18_6 = df
data_18_5 = data_18_5 %>% mutate(minute=tripduration/60)%>%
filter(minute<120 & minute>0)
data_17_6 = data_17_6 %>% mutate(minute=tripduration/60)%>%
filter(minute<120 & minute>0)
data_16_6 = data_16_6 %>% mutate(minute=tripduration/60)%>%
filter(minute<120 & minute>0)
data_17_12 = data_17_12 %>% mutate(minute=tripduration/60)%>%
filter(minute<120 & minute>0)
data_18_1 = data_18_1 %>% mutate(minute=tripduration/60)%>%
filter(minute<120 & minute>0)
data_18_6$factor_year = as.factor(data_18_6$birth.year)
summary_18_6 = data_18_6 %>% group_by(factor_year) %>%
summarise(Freq = n()) %>%
arrange(desc(Freq)) #1969
summary_18_6 = mutate(summary_18_6, time = rep("201806", nrow(summary_18_6)))
data_17_6$factor_year = as.factor(data_17_6$birth.year)
summary_17_6 = data_17_6 %>% group_by(factor_year) %>%
summarise(Freq = n()) %>%
arrange(desc(Freq)) #NULL
summary_17_6 = mutate(summary_17_6, time = rep("201706", nrow(summary_17_6)))
data_16_6$factor_year = as.factor(data_16_6$birth.year)
summary_16_6 = data_16_6 %>% group_by(factor_year) %>%
summarise(Freq = n()) %>%
arrange(desc(Freq)) #NULL
summary_16_6 = mutate(summary_16_6, time = rep("201606", nrow(summary_16_6)))
data_17_12$factor_year = as.factor(data_17_12$birth.year)
summary_17_12 = data_17_12 %>% group_by(factor_year) %>%
summarise(Freq = n()) %>%
arrange(desc(Freq)) #NULL
summary_17_12 = mutate(summary_17_12, time = rep("201712", nrow(summary_17_12)))
data_18_1$factor_year = as.factor(data_18_1$birth.year)
summary_18_1 = data_18_1 %>% group_by(factor_year) %>%
summarise(Freq = n()) %>%
arrange(desc(Freq)) #1969
summary_18_1 = mutate(summary_18_1, time = rep("201801", nrow(summary_18_1)))
data_18_5$factor_year = as.factor(data_18_5$birth.year)
summary_18_5 = data_18_5 %>% group_by(factor_year) %>%
summarise(Freq = n()) %>%
arrange(desc(Freq)) #1969
summary_18_5 = mutate(summary_18_5, time = rep("201805", nrow(summary_18_5)))
table = rbind(summary_16_6[1:3,], summary_17_6[1:3,], summary_17_12[1:3,],
summary_18_1[1:3,], summary_18_5[1:3,],summary_18_6[1:3,])
table$factor_year= as.character(table$factor_year)
table[1,1] = "NULL"
table$factor_year = factor(table$factor_year)
ggplot(table, aes(x = factor_year, y = Freq)) +
geom_bar(stat='identity', fill = "#fb6a4a", alpha = 0.8) +
facet_wrap(~factor(time)) +
xlab("users' birth year") +
ylab("frequency") +
ggtitle("Top Three Users' Birth Year")
gender = data.frame(group = c("unkown", "male", "female"),
value = summary(as.factor(df$gender)))
pie = ggplot(gender, aes(x="", y = value, fill=group)) +
geom_bar(width = 1, stat="identity") +
coord_polar("y", start = 0)
blank_theme <- theme_minimal()+
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
plot.title=element_text(size=14, face="bold")
)
pie + scale_fill_manual(values=c("#fbb4ae", "#b3cde3", "#ccebc5")) +
blank_theme + theme(axis.text.x=element_blank()) +
geom_text(aes(y = value/3 + c(0, cumsum(value)[-length(value)]),
label = c("10%","66%", "24%")), size=5) +
ggtitle("Ratio of users' gender of Citi Bike ")
gender = data.frame(group = c("unknown", "male", "female"),
value = summary(as.factor(df$gender)))
pie = ggplot(gender, aes(x="", y = value, fill=group)) +
geom_bar(width = 1, stat="identity") +
coord_polar("y", start = 0)
blank_theme <- theme_minimal()+
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
plot.title=element_text(size=14, face="bold")
)
pie + scale_fill_manual(values=c("#fbb4ae", "#b3cde3", "#ccebc5")) +
blank_theme + theme(axis.text.x=element_blank()) +
geom_text(aes(y = value/3 + c(0, cumsum(value)[-length(value)]),
label = c("10%","66%", "24%")), size=5) +
ggtitle("Ratio of users' gender of Citi Bike ")
df_2month = full_join(summary_18_6, summary_17_6, by = "factor_year")
df_3month = full_join(df_2month, summary_16_6, by = "factor_year")
t1 = data.frame(factor_year = df_3month$factor_year,Freq = df_3month$Freq.x, time = df_3month$time.x)
t2 = data.frame(factor_year = df_3month$factor_year,Freq = df_3month$Freq.y, time = df_3month$time.y)
t3 = data.frame(factor_year = df_3month$factor_year,Freq = df_3month$Freq, time = df_3month$time)
tf = rbind(t1,t2,t3)
ggplot(tf, aes(x = factor_year, y = Freq, color = as.factor(time))) + geom_point() +
coord_flip() + xlab("user's birth year") +
ggtitle("Frequency of Citi Bike users' birth year in different months")+
labs(fill="Time") + theme_grey(16)
set.seed(321)
index = sample(nrow(df), round(nrow(df)*0.001))
sample = df[index,]
g = ggplot(sample, aes(birth.year,minute))
g + geom_point(alpha = 0.5, col = "#fb6a4a") + ylab("trip duration (in min)") +
xlab("users' birth year") + ggtitle("Scatterplot of uses' birth year and trip duration (in sec) in Jun 2018") + theme_grey(16)
## get station info
station.info <- data_18_6 %>%
group_by(start.station.id) %>%
summarise(lat=as.numeric(start.station.latitude[1]),
long=as.numeric(start.station.longitude[1]),
name=start.station.name[1],
n.trips=n())
pal = colorNumeric(
palette="YlOrRd",
domain = station.info$n.trips
)
top10 = station.info %>% dplyr::arrange(desc(n.trips))
icon <- makeIcon(
iconUrl = "citi_bike_icon.png",
iconWidth = 20, iconHeight = 20,
iconAnchorX = 22, iconAnchorY = 22,
shadowWidth = 20, shadowHeight = 20,
shadowAnchorX = 4, shadowAnchorY = 62
)
leaflet(station.info) %>%setView(-74.00, 40.71, zoom = 12) %>%
leaflet::addProviderTiles("CartoDB.Positron") %>%
leaflet::addCircles(lng = ~long, lat = ~lat, color =~pal(n.trips)) %>%
leaflet::addLegend("bottomleft", pal = pal, value = ~n.trips, title = "Num of trips starting from this station") %>%
addMarkers(lng = ~top10[1:10,]$long, lat = ~top10[1:10,]$lat,  icon = icon)
NYCweather<-read.csv("./data/NYCweather.csv")
df$Date <- as.Date(df$starttime)
NYCweather$Date<-as.Date(NYCweather$Date)
df_weather <- inner_join(df,NYCweather,by="Date")
df_weather$Severe <- as.factor(df_weather$Severe)
hist(df_weather$Date, breaks="days", freq=TRUE)
ggplot(df_weather, aes(x=Date))+
geom_histogram(colour="white", fill="steelblue")+
ggtitle("Number of trips by day") + theme_grey(16)
NYCweather<-read.csv("./data/NYCweather.csv")
df$Date <- as.Date(df$starttime)
NYCweather$Date<-as.Date(NYCweather$Date)
df_weather <- inner_join(df,NYCweather,by="Date")
df_weather$Severe <- as.factor(df_weather$Severe)
ggplot(df_weather, aes(x=Date))+
geom_histogram(colour="white", fill="#fb6a4a")+
ggtitle("Number of trips by day") + theme_grey(16)
NYCweather<-read.csv("./data/NYCweather.csv")
df$Date <- as.Date(df$starttime)
NYCweather$Date<-as.Date(NYCweather$Date)
df_weather <- inner_join(df,NYCweather,by="Date")
df_weather$Severe <- as.factor(df_weather$Severe)
ggplot(df_weather, aes(x=Date))+
geom_bar(colour="white", fill="#fb6a4a")+
ggtitle("Number of trips by day") + theme_grey(16)
NYCweather<-read.csv("./data/NYCweather.csv")
df$Date <- as.Date(df$starttime)
NYCweather$Date<-as.Date(NYCweather$Date)
df_weather <- inner_join(df,NYCweather,by="Date")
df_weather$Severe <- as.factor(df_weather$Severe)
ggplot(df_weather, aes(x=Date))+
geom_bar(position='dodge', colour="white", fill="#fb6a4a")+
ggtitle("Number of trips by day") + theme_grey(16)
ggplot(df_weather, aes(x=Severe))+
geom_bar(colour="white", fill="#fb6a4a")+
ggtitle("Number of trips per day for severe and unsevere weather condition")
df_by_temp <- df_weather %>% group_by(Temperature) %>% summarise(n_distinct(starttime))
ggplot(data = df_by_temp, aes(x=as.numeric(Temperature), y=`n_distinct(starttime)`))+
stat_summary(geom="bar", fill="steelblue")+
xlab("Temperature")+
ylab("Average trips per day")+
ggtitle("Average daily trips in different temperatures")
df_by_windspeed <- df_weather %>% group_by(Windspeed) %>% summarise(n_distinct(starttime))
ggplot(data = df_by_windspeed, aes(x=as.numeric(Windspeed), y=`n_distinct(starttime)`))+
stat_summary(geom="bar", fill="steelblue")+
xlab("Windspeed")+
ylab("Average trips per day")+
ggtitle("Average daily trips in different windspeeds")
df_by_precip <- df_weather %>% group_by(Precipitation) %>% summarise(n_distinct(starttime))
ggplot(data = df_by_precip, aes(x=as.numeric(Precipitation), y=`n_distinct(starttime)`))+
stat_summary(geom="bar", fill="steelblue")+
xlab("Precipitation")+
ylab("Average trips per day")+
ggtitle("Average daily trips in different precipitations")
df_by_temp <- df_weather %>% group_by(Temperature) %>% summarise(n_distinct(starttime))
ggplot(data = df_by_temp, aes(x=as.numeric(Temperature), y=`n_distinct(starttime)`))+
stat_summary(geom="bar", fill="#fb6a4a")+
xlab("Temperature")+
ylab("Average trips per day")+
ggtitle("Average daily trips in different temperatures") +theme_grey(16)
df_by_windspeed <- df_weather %>% group_by(Windspeed) %>% summarise(n_distinct(starttime))
ggplot(data = df_by_windspeed, aes(x=as.numeric(Windspeed), y=`n_distinct(starttime)`))+
stat_summary(geom="bar", fill="#fb6a4a")+
xlab("Windspeed")+
ylab("Average trips per day")+
ggtitle("Average daily trips in different windspeeds")+theme_grey(16)
df_by_precip <- df_weather %>% group_by(Precipitation) %>% summarise(n_distinct(starttime))
ggplot(data = df_by_precip, aes(x=as.numeric(Precipitation), y=`n_distinct(starttime)`))+
stat_summary(geom="bar", fill="#fb6a4a")+
xlab("Precipitation")+
ylab("Average trips per day")+
ggtitle("Average daily trips in different precipitations")+theme_grey(16)
ggplot(data = df_weather,
aes(x=factor(Severe), y=minute))+
xlab("Severity of weather")+ylab("Average trip duration")+
stat_summary(fun.y="mean", geom="bar")+
ggtitle("Average trip duration for severe and unsevere weather condition")
+ theme_grey(16)
ggplot(data = df_weather,
aes(x=factor(Severe), y=minute))+
xlab("Severity of weather")+ylab("Average trip duration")+
stat_summary(fun.y="mean", geom="bar")+
ggtitle("Average trip duration for severe and unsevere weather condition") + theme_grey(16)
ggplot(data = df_weather,
aes(x=factor(Severe), y=minute,fill = '#fb6a4a'))+
xlab("Severity of weather")+ylab("Average trip duration")+
stat_summary(fun.y="mean", geom="bar")+
ggtitle("Average trip duration for severe and unsevere weather condition") + theme_grey(16)
ggplot(data = df_weather,
aes(x=factor(Severe), y=minute,color = '#fb6a4a'))+
xlab("Severity of weather")+ylab("Average trip duration")+
stat_summary(fun.y="mean", geom="bar")+
ggtitle("Average trip duration for severe and unsevere weather condition") + theme_grey(16)
ggplot(data = df_weather,
aes(x=factor(Severe), y=minute,fill= '#fb6a4a'))+
xlab("Severity of weather")+ylab("Average trip duration")+
stat_summary(fun.y="mean", geom="bar")+
ggtitle("Average trip duration for severe and unsevere weather condition") + theme_grey(16)+ theme(legend.position="none")
ggplot(data = df_weather,
aes(x = Windspeed, y = minute,fill='#fb6a4a')) +
scale_x_continuous("Windspeed") +
scale_y_continuous("Average trip duration in minutes") +
ggtitle("Trip duration vs. Windspeed") +
stat_summary(fun.y="mean", geom = "line", size=1)+theme_grey(16)+ theme(legend.position="none")
ggplot(data = df_weather,
aes(x = Temperature, y = minute,fill='#fb6a4a')) +
scale_x_continuous("Temperature") +
scale_y_continuous("Average trip duration in minutes") +
ggtitle("Trip duration vs. Temperature") +
stat_summary(fun.y="mean", geom="line", size=1)+ theme_grey(16)+ theme(legend.position="none")
ggplot(data = df_weather,
aes(x = Precipitation, y = minute,fill='#fb6a4a')) +
scale_x_continuous("Precipitation") +
scale_y_continuous("Average trip duration in minutes") +
ggtitle("Trip duration vs. Precipitation") +
stat_summary(fun.y="mean", geom = "line", size=1)+ theme_grey(16)+ theme(legend.position="none")
ggplot(data = df_weather,
aes(x = Windspeed, y = minute,color='#fb6a4a')) +
scale_x_continuous("Windspeed") +
scale_y_continuous("Average trip duration in minutes") +
ggtitle("Trip duration vs. Windspeed") +
stat_summary(fun.y="mean", geom = "line", size=1)+theme_grey(16)+ theme(legend.position="none")
ggplot(data = df_weather,
aes(x = Temperature, y = minute,color='#fb6a4a')) +
scale_x_continuous("Temperature") +
scale_y_continuous("Average trip duration in minutes") +
ggtitle("Trip duration vs. Temperature") +
stat_summary(fun.y="mean", geom="line", size=1)+ theme_grey(16)+ theme(legend.position="none")
ggplot(data = df_weather,
aes(x = Precipitation, y = minute,color='#fb6a4a')) +
scale_x_continuous("Precipitation") +
scale_y_continuous("Average trip duration in minutes") +
ggtitle("Trip duration vs. Precipitation") +
stat_summary(fun.y="mean", geom = "line", size=1)+ theme_grey(16)+ theme(legend.position="none")
library(dygraphs)
library(xts)
library(lubridate)
library(zoo)
df_timeseries <- read.csv('./data/data_2017_2018.csv')
a <- lubridate::mdy_hms(df_timeseries$starttime)
b <- as.Date(df_timeseries$starttime)
b[is.na(b)] <- a[!is.na(a)]
df_timeseries$starttime <- b
df_timeseries <- df_timeseries %>% mutate(time = format(as.Date(starttime), "%Y-%m"))
df_timeseries <- df_timeseries[,c("time","usertype")]
df_subscriber <- df_timeseries %>% subset(usertype == 'Subscriber')
df_customer <- df_timeseries %>% subset(usertype == 'Customer')
df_subscriber <- df_subscriber %>% group_by(time) %>% summarise(Number = n())
df_customer <- df_customer %>% group_by(time) %>% summarise(Number = n())
ts_subscriber <- xts::xts(df_subscriber$Number,as.Date(as.yearmon(df_subscriber$time)))
ts_customer <- xts::xts(df_customer$Number,as.Date(as.yearmon(df_customer$time)))
ts <- cbind(ts_subscriber,ts_customer)
dygraph(ts,main = 'Impact of season',ylab = "Frequency") %>% dySeries('..1',label = 'subscriber ') %>% dySeries('..2',label = 'customer') %>% dyLegend(show = "always", hideOnMouseOut = FALSE,width=400) %>%
dyOptions(colors = RColorBrewer::brewer.pal(3, "Set2"))
install.packages('memisc')
ggplot(summary_18_6, aes(x = factor_year, y = Freq)) + geom_point(col = "#fb6a4a") +
coord_flip() + xlab("user's birth year") + scale_y_continuous(labels = paste0(ylab, "K"),breaks = 10^3 * ylab)
ggtitle("Frequency of Citi Bike users' birth year in 2018/6") + theme_grey(16)
ggplot(summary_18_6, aes(x = factor_year, y = Freq)) + geom_point(col = "#fb6a4a") +
coord_flip() + xlab("user's birth year") + scale_y_continuous(labels = paste0(ylab, "K"),breaks = 10^3 * ylab)+ggtitle("Frequency of Citi Bike users' birth year in 2018/6") + theme_grey(16)
ggplot(summary_18_6, aes(x = factor_year, y = Freq)) + geom_point(col = "#fb6a4a") +
coord_flip() + xlab("user's birth year") + scale_y_continuous(labels = paste0(ylab, "K"))+ggtitle("Frequency of Citi Bike users' birth year in 2018/6") + theme_grey(16)
ggplot(data=df,mapping=aes(minute)) + geom_histogram(fill='#fb6a4a',color='black')+ggtitle('Distribution of time duration') +xlab('minutes over one trip') + ylab('Frequency of trips')+ theme_grey(16)+scale_y_continuous(name = "percent", labels = scales::percent)
ggplot(data=df,mapping=aes(minute)) + geom_histogram(fill='#fb6a4a',color='black')+ggtitle('Distribution of time duration') +xlab('minutes over one trip') + ylab('Frequency of trips')+ theme_grey(16)+scale_y_continuous(name = "Number", labels = scales::percent*0.000001)
ggplot(df_weather, aes(x=Severe))+
geom_bar(colour="white", fill="#fb6a4a")+ scale_y_continuous(labels = paste0(ylab, "K"),breaks = 10^3 * ylab)+ggtitle("Number of trips per day for severe and unsevere weather condition") +theme_grey(16) + ylab('Frequency')
ggplot(df_weather, aes(x=Severe))+
geom_bar(colour="white", fill="#fb6a4a")+ scale_y_continuous(labels = paste0(ylab, "K"),breaks = ylab*10)+ggtitle("Number of trips per day for severe and unsevere weather condition") +theme_grey(16) + ylab('Frequency')
ggplot(df_weather, aes(x=Severe))+
geom_bar(colour="white", fill="#fb6a4a")+ scale_y_continuous(labels = paste0(ylab, "K"),breaks = ylab*.10)+ggtitle("Number of trips per day for severe and unsevere weather condition") +theme_grey(16) + ylab('Frequency')
